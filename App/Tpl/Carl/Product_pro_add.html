<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
	<title> 后台数据管理中心</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="创高安防">
	<meta name="author" content="chuango_Karl">

    <script src="__PUBLIC__/Admin/ue/editor_config.js" type="text/javascript"></script>
	<script src="__PUBLIC__/Admin/ue/editor_all_min.js" type="text/javascript"></script>
	<include file="public:css" />
		
</head>

<body>
	<include file="public:header" />
		<div class="container-fluid">
		<div class="row-fluid">
			<include file="public:left" />
			<!-- content start -->
			<div id="content" class="span10">
				<div>
					<ul class="breadcrumb">
						<li>
							<a href="__GROUP__">Home</a> <span class="divider">/</span>
						</li>
						<li>
							<a href="__URL__/index">产品分类</a><span class="divider">/</span>
						</li>
                        <li>
							<a href="__URL__/pro_lists">产品列表</a>
						</li>
					</ul>
				</div>
			<present name="msg">
            <div class="row-fluid">	
                <div class="alert alert-{$msg[0]}">
                    <button type="button" class="close" data-dismiss="alert">×</button>
                    <strong>系统提示:&nbsp;&nbsp;</strong> {$msg[1]}
                </div>
            </div>	
            </present>
            <div class="row-fluid sortable">
				<div class="box span12">
					<div class="box-header well" data-original-title>
						<h2><i class="icon-edit"></i>产品</h2>
					</div>
					<div class="box-content">
						<form class="form-horizontal" action="__URL__/pro_add" method="post" enctype="multipart/form-data" onsubmit="return addpro();">
                          <input type="hidden" name="action" value="add" />
						  <fieldset>
							<legend>添加产品</legend>
							<div class="control-group">
							  <label class="control-label" for="pro_name">产品名<span class="red">*</span></label>
							  <div class="controls">
								<input type="text" class="span4 _validate" id="pro_name" name="pro_name"  />
                                <span class="help-inline"></span>
							  </div>
							</div>
                            <div class="control-group">
							  <label class="control-label" for="pro_code">产品编号<span class="red">*</span></label>
							  <div class="controls">
								<input type="text" class="span4 _validate" id="pro_code" name="pro_code"  />
                                <span class="help-inline"></span>
							  </div>
							</div>
                            <div class="control-group">
							  <label class="control-label" for="pro_title">产品title</label>
							  <div class="controls">
								<input class="span4" class="input-xlarge span 6" id="pro_title" name="pro_title"/>
							  </div>
							</div>
							<div class="control-group">
							  <label class="control-label" for="pro_ca_id">产品分类<span class="red">*</span></label>
							  <div class="controls">
								<select   data-rel="chosen" name="pro_ca_id" id="pro_ca_id">
                                	{$categorys|getOptions=$ca}
                                </select>
							  </div>
							</div>
                            <div class="control-group">
							  <label class="control-label" for="pro_order">产品次序</label>
							  <div class="controls">
								<input type="text" class="input-xlarge span1" id="pro_order" value="" name="pro_order" />
							  </div>
							</div>
							<div class="control-group">
							  <label class="control-label" for="pro_keywords">产品关键字</label>
							  <div class="controls">
								<input type="text" class="input-xlarge span6" id="pro_keywords" value="" name="pro_keywords" />
							  </div>
							</div>
                            <div class="control-group">
							  <label class="control-label" for="pro_desc">产品描述</label>
							  <div class="controls">
								<textarea class="span4" rows="3" id="pro_desc" name="pro_desc"></textarea>
							  </div>
							</div>
                            <div class="control-group">
							  <label class="control-label" for="pro_thumb">产品缩略图<span class="red">*</span></label>
							  <div class="controls">
								<input class="input-file uniform_on _validate" id="pro_thumb" type="file" name="pro_thumb" />
                                <span class="help-inline"></span>
							  </div>
							</div> 
                            <div class="control-group">
							  	<label class="control-label" for="pro_relatepro">产品关联</label>
							  	<div class="controls">
									<select data-placeholder="产品关联" id="pro_relatepro" class="span4" name="pro_relatepro[]" multiple data-rel="chosen">
										{$pro_list|pro_options}
									</select>
							  	</div>
							</div>             
							<div class="control-group">
                            	
							  <label class="control-label" for="pro_template">产品模板</label>
							  <div class="controls">
                              	<input type="text" class="input-xlarge _validate" id="pro_template" value="" name="pro_template" />
                                <span class="help-inline"></span>
								<p>请确保模板目录下存在该文件。</p>
							  </div>
							</div>
							<div class="form-actions">
							  <button type="submit" class="btn btn-primary">发布</button>
							  <button type="reset" class="btn">取消</button>
							</div>
						  </fieldset>
						</form>   
					</div>
				</div>
			</div>
			<!-- content end -->
		</div>
		</div>
		<hr>
		<div class="modal hide fade" id="myModal">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">×</button>
				<h3>Settings</h3>
			</div>
			<div class="modal-body">
				<p>Here settings can be configured...</p>
			</div>
			<div class="modal-footer">
				<a href="#" class="btn" data-dismiss="modal">Close</a>
				<a href="#" class="btn btn-primary">Save changes</a>
			</div>
		</div>
		<include file="public:footer" />
	</div>
	<include file="public:js" />
    <script type="text/javascript">
		function addpro(){
			if($(".control-group").hasClass("error")){
				return false;
			}
			var pro_name = $("#pro_name").val();
			var pro_code = $("#pro_code").val();
			var pro_thumb = $("#pro_thumb").val();
			var pro_template = $("#pro_template").val();
			var reg = new RegExp(/.jpg$|.png$|.jepg$|.gif/i);
			if(pro_name==""){
				$("#pro_name").parent().parent().addClass("error");
				$("#pro_name").siblings("span.help-inline").html("产品名不能为空！");
				return false;
			}else if(pro_code==""){
				$("#pro_code").parent().parent().addClass("error");
				$("#pro_code").siblings("span.help-inline").html("产品编码不能为空！");
				return false;
			}else if(!reg.test(pro_thumb)){
				$("#pro_thumb").parent().parent().addClass("error");
				$("#pro_thumb").siblings("span.help-inline").html("不被支持的图片格式！");
				return false;
			}else{
				return true;
			}
		}
		
		$("#pro_name").blur(function(){
			if($("#pro_name").val()=="")return;
			$.post("__URL__/proCheck", "name="+$("#pro_name").val(), function(res){
				if(res!="correct"){
					$("#pro_name").parent().parent().addClass("error");
					$("#pro_name").siblings("span.help-inline").html("已存在该产品！");
				}	
			}, "text");
		});
		$("#pro_code").blur(function(){
			if($("#pro_code").val()=="")return;
			$.post("__URL__/proCheck", "code="+$("#pro_code").val(), function(res){
				if(res!="correct"){
					$("#pro_code").parent().parent().addClass("error");
					$("#pro_code").siblings("span.help-inline").html("已存在该产品编码！");
				}	
			}, "text");
		});
		$("#pro_template").blur(function(){
			if($("#pro_template").val()=="")return;
			$.post("__URL__/proCheck", "template="+$("#pro_template").val(), function(res){
				if(res!="correct"){
					$("#pro_template").parent().parent().addClass("error");
					$("#pro_template").siblings("span.help-inline").html("模板文件不存在！");
				}	
			}, "text");
		});
	</script>
</body>
</html>
